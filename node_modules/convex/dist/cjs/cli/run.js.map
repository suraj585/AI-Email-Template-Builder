{
  "version": 3,
  "sources": ["../../../src/cli/run.ts"],
  "sourcesContent": ["import { Command } from \"@commander-js/extra-typings\";\nimport { oneoffContext } from \"../bundler/context.js\";\nimport {\n  fetchDeploymentCredentialsProvisionProd,\n  deploymentSelectionFromOptions,\n} from \"./lib/api.js\";\nimport { actionDescription } from \"./lib/command.js\";\nimport { runInDeployment } from \"./lib/run.js\";\nimport { ensureHasConvexDependency } from \"./lib/utils/utils.js\";\n\nexport const run = new Command(\"run\")\n  .description(\"Run a function (query, mutation, or action) on your deployment\")\n  .allowExcessArguments(false)\n  .addRunOptions()\n  .addDeploymentSelectionOptions(actionDescription(\"Run the function on\"))\n  .showHelpAfterError()\n  .action(async (functionName, argsString, options) => {\n    const ctx = oneoffContext();\n\n    const deploymentSelection = deploymentSelectionFromOptions(options);\n\n    const {\n      adminKey,\n      url: deploymentUrl,\n      deploymentType,\n    } = await fetchDeploymentCredentialsProvisionProd(ctx, deploymentSelection);\n\n    await ensureHasConvexDependency(ctx, \"run\");\n\n    if (deploymentType === \"prod\" && options.push) {\n      return await ctx.crash({\n        exitCode: 1,\n        errorType: \"fatal\",\n        printedMessage:\n          `\\`convex run\\` doesn't support pushing functions to prod deployments. ` +\n          `Remove the --push flag. To push to production use \\`npx convex deploy\\`.`,\n      });\n    }\n\n    await runInDeployment(ctx, {\n      deploymentUrl,\n      adminKey,\n      functionName,\n      argsString: argsString ?? \"{}\",\n      componentPath: options.component,\n      identityString: options.identity,\n      push: !!options.push,\n      watch: !!options.watch,\n      typecheck: options.typecheck,\n      typecheckComponents: options.typecheckComponents,\n      codegen: options.codegen === \"enable\",\n      liveComponentSources: !!options.liveComponentSources,\n    });\n  });\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAwB;AACxB,qBAA8B;AAC9B,iBAGO;AACP,qBAAkC;AAClC,iBAAgC;AAChC,mBAA0C;AAEnC,MAAM,MAAM,IAAI,6BAAQ,KAAK,EACjC,YAAY,gEAAgE,EAC5E,qBAAqB,KAAK,EAC1B,cAAc,EACd,kCAA8B,kCAAkB,qBAAqB,CAAC,EACtE,mBAAmB,EACnB,OAAO,OAAO,cAAc,YAAY,YAAY;AACnD,QAAM,UAAM,8BAAc;AAE1B,QAAM,0BAAsB,2CAA+B,OAAO;AAElE,QAAM;AAAA,IACJ;AAAA,IACA,KAAK;AAAA,IACL;AAAA,EACF,IAAI,UAAM,oDAAwC,KAAK,mBAAmB;AAE1E,YAAM,wCAA0B,KAAK,KAAK;AAE1C,MAAI,mBAAmB,UAAU,QAAQ,MAAM;AAC7C,WAAO,MAAM,IAAI,MAAM;AAAA,MACrB,UAAU;AAAA,MACV,WAAW;AAAA,MACX,gBACE;AAAA,IAEJ,CAAC;AAAA,EACH;AAEA,YAAM,4BAAgB,KAAK;AAAA,IACzB;AAAA,IACA;AAAA,IACA;AAAA,IACA,YAAY,cAAc;AAAA,IAC1B,eAAe,QAAQ;AAAA,IACvB,gBAAgB,QAAQ;AAAA,IACxB,MAAM,CAAC,CAAC,QAAQ;AAAA,IAChB,OAAO,CAAC,CAAC,QAAQ;AAAA,IACjB,WAAW,QAAQ;AAAA,IACnB,qBAAqB,QAAQ;AAAA,IAC7B,SAAS,QAAQ,YAAY;AAAA,IAC7B,sBAAsB,CAAC,CAAC,QAAQ;AAAA,EAClC,CAAC;AACH,CAAC;",
  "names": []
}
